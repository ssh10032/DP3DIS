2023-08-22 11:32:30,626 INFO    MainThread:28379 [wandb_setup.py:_flush():76] Configure stats pid to 28379
2023-08-22 11:32:30,627 INFO    MainThread:28379 [wandb_setup.py:_flush():76] Loading settings from /home/songoh/.config/wandb/settings
2023-08-22 11:32:30,627 INFO    MainThread:28379 [wandb_setup.py:_flush():76] Loading settings from /media/songoh/ssh3/songoh_ws/MaskDNtoBBox_GPU0/wandb/settings
2023-08-22 11:32:30,627 INFO    MainThread:28379 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'_require_service': 'True'}
2023-08-22 11:32:30,627 INFO    MainThread:28379 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'main_instance_segmentation.py', 'program': '/media/songoh/ssh3/songoh_ws/MaskDNtoBBox_GPU0/main_instance_segmentation.py'}
2023-08-22 11:32:30,627 INFO    MainThread:28379 [wandb_init.py:_log_setup():461] Logging user logs to /media/songoh/ssh3/songoh_ws/MaskDNtoBBox_GPU0/wandb/run-20230822_113230-3tstlv1l/logs/debug.log
2023-08-22 11:32:30,627 INFO    MainThread:28379 [wandb_init.py:_log_setup():462] Logging internal logs to /media/songoh/ssh3/songoh_ws/MaskDNtoBBox_GPU0/wandb/run-20230822_113230-3tstlv1l/logs/debug-internal.log
2023-08-22 11:32:30,628 INFO    MainThread:28379 [wandb_init.py:init():495] calling init triggers
2023-08-22 11:32:30,629 INFO    MainThread:28379 [wandb_init.py:init():498] wandb.init called with sweep_config: {}
config: {}
2023-08-22 11:32:30,629 INFO    MainThread:28379 [wandb_init.py:init():548] starting backend
2023-08-22 11:32:30,630 INFO    MainThread:28379 [wandb_init.py:init():552] setting up manager
2023-08-22 11:32:30,635 INFO    MainThread:28379 [backend.py:_multiprocessing_setup():97] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2023-08-22 11:32:30,643 INFO    MainThread:28379 [wandb_init.py:init():558] backend started and connected
2023-08-22 11:32:30,646 INFO    MainThread:28379 [wandb_init.py:init():636] updated telemetry
2023-08-22 11:32:30,647 INFO    MainThread:28379 [wandb_init.py:init():667] communicating run to backend with 30 second timeout
2023-08-22 11:32:31,159 INFO    MainThread:28379 [wandb_run.py:_on_init():1982] communicating current version
2023-08-22 11:32:31,203 INFO    MainThread:28379 [wandb_run.py:_on_init():1986] got version response upgrade_message: "wandb version 0.15.8 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2023-08-22 11:32:31,203 INFO    MainThread:28379 [wandb_init.py:init():700] starting run threads in backend
2023-08-22 11:32:35,501 INFO    MainThread:28379 [wandb_run.py:_console_start():1962] atexit reg
2023-08-22 11:32:35,503 INFO    MainThread:28379 [wandb_run.py:_redirect():1820] redirect: SettingsConsole.WRAP_RAW
2023-08-22 11:32:35,503 INFO    MainThread:28379 [wandb_run.py:_redirect():1885] Wrapping output streams.
2023-08-22 11:32:35,503 INFO    MainThread:28379 [wandb_run.py:_redirect():1907] Redirects installed.
2023-08-22 11:32:35,504 INFO    MainThread:28379 [wandb_init.py:init():732] run started, returning control to user process
2023-08-22 11:32:42,177 INFO    MainThread:28379 [wandb_run.py:_config_callback():1152] config_cb None None {'general_train_mode': True, 'general_task': 'instance_segmentation', 'general_seed': 'None', 'general_checkpoint': 'None', 'general_backbone_checkpoint': 'None', 'general_freeze_backbone': False, 'general_linear_probing_backbone': False, 'general_train_on_segments': True, 'general_eval_on_segments': True, 'general_filter_out_instances': False, 'general_save_visualizations': False, 'general_visualization_point_size': 20, 'general_decoder_id': -1, 'general_export': False, 'general_use_dbscan': False, 'general_ignore_class_threshold': 100, 'general_project_name': 'scannet', 'general_workspace': 'jonasschult', 'general_experiment_name': 'dn to bbox gpu0', 'general_num_targets': 19, 'general_add_instance': True, 'general_dbscan_eps': 0.95, 'general_dbscan_min_points': 1, 'general_export_threshold': 0.0001, 'general_reps_per_epoch': 1, 'general_on_crops': False, 'general_scores_threshold': 0.0, 'general_iou_threshold': 1.0, 'general_area': 5, 'general_eval_inner_core': -1, 'general_topk_per_image': 100, 'general_ignore_mask_idx': [], 'general_max_batch_size': 99999999, 'general_save_dir': 'saved/dn to bbox gpu0', 'general_gpus': 1, 'data_train_mode': 'train', 'data_validation_mode': 'validation', 'data_test_mode': 'validation', 'data_ignore_label': 255, 'data_add_raw_coordinates': True, 'data_add_colors': True, 'data_add_normals': False, 'data_in_channels': 3, 'data_num_labels': 20, 'data_add_instance': True, 'data_task': 'instance_segmentation', 'data_pin_memory': False, 'data_num_workers': 4, 'data_batch_size': 3, 'data_test_batch_size': 1, 'data_cache_data': False, 'data_voxel_size': 0.02, 'data_reps_per_epoch': 1, 'data_cropping': False, 'data_cropping_args_min_points': 30000, 'data_cropping_args_aspect': 0.8, 'data_cropping_args_min_crop': 0.5, 'data_cropping_args_max_crop': 1.0, 'data_crop_min_size': 20000, 'data_crop_length': 6.0, 'data_cropping_v1': True, 'data_train_dataloader__target_': 'torch.utils.data.DataLoader', 'data_train_dataloader_shuffle': True, 'data_train_dataloader_pin_memory': False, 'data_train_dataloader_num_workers': 4, 'data_train_dataloader_batch_size': 3, 'data_validation_dataloader__target_': 'torch.utils.data.DataLoader', 'data_validation_dataloader_shuffle': False, 'data_validation_dataloader_pin_memory': False, 'data_validation_dataloader_num_workers': 4, 'data_validation_dataloader_batch_size': 1, 'data_test_dataloader__target_': 'torch.utils.data.DataLoader', 'data_test_dataloader_shuffle': False, 'data_test_dataloader_pin_memory': False, 'data_test_dataloader_num_workers': 4, 'data_test_dataloader_batch_size': 1, 'data_train_dataset__target_': 'datasets.semseg.SemanticSegmentationDataset', 'data_train_dataset_dataset_name': 'scannet', 'data_train_dataset_data_dir': 'data/processed/scannet', 'data_train_dataset_image_augmentations_path': 'conf/augmentation/albumentations_aug.yaml', 'data_train_dataset_volume_augmentations_path': 'conf/augmentation/volumentations_aug.yaml', 'data_train_dataset_label_db_filepath': 'data/processed/scannet/label_database.yaml', 'data_train_dataset_color_mean_std': 'data/processed/scannet/color_mean_std.yaml', 'data_train_dataset_data_percent': 1.0, 'data_train_dataset_mode': 'train', 'data_train_dataset_ignore_label': 255, 'data_train_dataset_num_labels': 20, 'data_train_dataset_add_raw_coordinates': True, 'data_train_dataset_add_colors': True, 'data_train_dataset_add_normals': False, 'data_train_dataset_add_instance': True, 'data_train_dataset_instance_oversampling': 0.0, 'data_train_dataset_place_around_existing': False, 'data_train_dataset_point_per_cut': 0, 'data_train_dataset_max_cut_region': 0, 'data_train_dataset_flip_in_center': False, 'data_train_dataset_noise_rate': 0, 'data_train_dataset_resample_points': 0, 'data_train_dataset_add_unlabeled_pc': False, 'data_train_dataset_cropping': False, 'data_train_dataset_cropping_args_min_points': 30000, 'data_train_dataset_cropping_args_aspect': 0.8, 'data_train_dataset_cropping_args_min_crop': 0.5, 'data_train_dataset_cropping_args_max_crop': 1.0, 'data_train_dataset_is_tta': False, 'data_train_dataset_crop_min_size': 20000, 'data_train_dataset_crop_length': 6.0, 'data_train_dataset_filter_out_classes': [0, 1], 'data_train_dataset_label_offset': 2, 'data_validation_dataset__target_': 'datasets.semseg.SemanticSegmentationDataset', 'data_validation_dataset_dataset_name': 'scannet', 'data_validation_dataset_data_dir': 'data/processed/scannet', 'data_validation_dataset_image_augmentations_path': 'None', 'data_validation_dataset_volume_augmentations_path': 'None', 'data_validation_dataset_label_db_filepath': 'data/processed/scannet/label_database.yaml', 'data_validation_dataset_color_mean_std': 'data/processed/scannet/color_mean_std.yaml', 'data_validation_dataset_data_percent': 1.0, 'data_validation_dataset_mode': 'validation', 'data_validation_dataset_ignore_label': 255, 'data_validation_dataset_num_labels': 20, 'data_validation_dataset_add_raw_coordinates': True, 'data_validation_dataset_add_colors': True, 'data_validation_dataset_add_normals': False, 'data_validation_dataset_add_instance': True, 'data_validation_dataset_cropping': False, 'data_validation_dataset_is_tta': False, 'data_validation_dataset_crop_min_size': 20000, 'data_validation_dataset_crop_length': 6.0, 'data_validation_dataset_filter_out_classes': [0, 1], 'data_validation_dataset_label_offset': 2, 'data_test_dataset__target_': 'datasets.semseg.SemanticSegmentationDataset', 'data_test_dataset_dataset_name': 'scannet', 'data_test_dataset_data_dir': 'data/processed/scannet', 'data_test_dataset_image_augmentations_path': 'None', 'data_test_dataset_volume_augmentations_path': 'None', 'data_test_dataset_label_db_filepath': 'data/processed/scannet/label_database.yaml', 'data_test_dataset_color_mean_std': 'data/processed/scannet/color_mean_std.yaml', 'data_test_dataset_data_percent': 1.0, 'data_test_dataset_mode': 'validation', 'data_test_dataset_ignore_label': 255, 'data_test_dataset_num_labels': 20, 'data_test_dataset_add_raw_coordinates': True, 'data_test_dataset_add_colors': True, 'data_test_dataset_add_normals': False, 'data_test_dataset_add_instance': True, 'data_test_dataset_cropping': False, 'data_test_dataset_is_tta': False, 'data_test_dataset_crop_min_size': 20000, 'data_test_dataset_crop_length': 6.0, 'data_test_dataset_filter_out_classes': [0, 1], 'data_test_dataset_label_offset': 2, 'data_train_collation__target_': 'datasets.utils.VoxelizeCollate', 'data_train_collation_ignore_label': 255, 'data_train_collation_voxel_size': 0.02, 'data_train_collation_mode': 'train', 'data_train_collation_small_crops': False, 'data_train_collation_very_small_crops': False, 'data_train_collation_batch_instance': False, 'data_train_collation_probing': False, 'data_train_collation_task': 'instance_segmentation', 'data_train_collation_ignore_class_threshold': 100, 'data_train_collation_filter_out_classes': [0, 1], 'data_train_collation_label_offset': 2, 'data_train_collation_num_queries': 100, 'data_validation_collation__target_': 'datasets.utils.VoxelizeCollate', 'data_validation_collation_ignore_label': 255, 'data_validation_collation_voxel_size': 0.02, 'data_validation_collation_mode': 'validation', 'data_validation_collation_batch_instance': False, 'data_validation_collation_probing': False, 'data_validation_collation_task': 'instance_segmentation', 'data_validation_collation_ignore_class_threshold': 100, 'data_validation_collation_filter_out_classes': [0, 1], 'data_validation_collation_label_offset': 2, 'data_validation_collation_num_queries': 100, 'data_test_collation__target_': 'datasets.utils.VoxelizeCollate', 'data_test_collation_ignore_label': 255, 'data_test_collation_voxel_size': 0.02, 'data_test_collation_mode': 'validation', 'data_test_collation_batch_instance': False, 'data_test_collation_probing': False, 'data_test_collation_task': 'instance_segmentation', 'data_test_collation_ignore_class_threshold': 100, 'data_test_collation_filter_out_classes': [0, 1], 'data_test_collation_label_offset': 2, 'data_test_collation_num_queries': 100, 'logging': [{'_target_': 'pytorch_lightning.loggers.WandbLogger', 'project': 'scannet', 'name': 'dn to bbox gpu0', 'save_dir': 'saved/dn to bbox gpu0', 'entity': 'schult', 'resume': 'allow', 'id': 'dn to bbox gpu0'}], 'model__target_': 'models.Mask3D', 'model_hidden_dim': 128, 'model_dim_feedforward': 1024, 'model_num_queries': 100, 'model_num_heads': 8, 'model_num_decoders': 3, 'model_dropout': 0.0, 'model_pre_norm': False, 'model_use_level_embed': False, 'model_normalize_pos_enc': True, 'model_positional_encoding_type': 'fourier', 'model_gauss_scale': 1.0, 'model_hlevels': [0, 1, 2, 3], 'model_anchor_dim': 6, 'model_non_parametric_queries': False, 'model_random_query_both': False, 'model_random_normal': False, 'model_random_queries': False, 'model_use_np_features': False, 'model_query_selection': True, 'model_sample_sizes': [200, 800, 3200, 12800, 51200], 'model_max_sample_size': False, 'model_shared_decoder': True, 'model_num_classes': 19, 'model_train_on_segments': True, 'model_scatter_type': 'mean', 'model_voxel_size': 0.02, 'model_config_backbone__target_': 'models.Res16UNet34C', 'model_config_backbone_config_dialations': [1, 1, 1, 1], 'model_config_backbone_config_conv1_kernel_size': 5, 'model_config_backbone_config_bn_momentum': 0.02, 'model_config_backbone_in_channels': 3, 'model_config_backbone_out_channels': 20, 'model_config_backbone_out_fpn': True, 'metrics__target_': 'models.metrics.ConfusionMatrix', 'metrics_num_classes': 20, 'metrics_ignore_label': 255, 'optimizer__target_': 'torch.optim.AdamW', 'optimizer_lr': 0.0001, 'scheduler_scheduler__target_': 'torch.optim.lr_scheduler.OneCycleLR', 'scheduler_scheduler_max_lr': 0.0001, 'scheduler_scheduler_epochs': 1001, 'scheduler_scheduler_steps_per_epoch': -1, 'scheduler_pytorch_lightning_params_interval': 'step', 'trainer_deterministic': False, 'trainer_max_epochs': 1001, 'trainer_min_epochs': 1, 'trainer_resume_from_checkpoint': 'None', 'trainer_check_val_every_n_epoch': 50, 'trainer_num_sanity_val_steps': 2, 'callbacks': [{'_target_': 'pytorch_lightning.callbacks.ModelCheckpoint', 'monitor': 'val_mean_ap_50', 'save_last': True, 'save_top_k': 1, 'mode': 'max', 'dirpath': 'saved/dn to bbox gpu0', 'filename': '{epoch}-{val_mean_ap_50:.3f}', 'every_n_epochs': 1}, {'_target_': 'pytorch_lightning.callbacks.LearningRateMonitor'}], 'matcher__target_': 'models.matcher.HungarianMatcher', 'matcher_cost_class': 2.0, 'matcher_cost_mask': 5.0, 'matcher_cost_dice': 2.0, 'matcher_num_points': -1, 'loss__target_': 'models.criterion.SetCriterion', 'loss_num_classes': 19, 'loss_eos_coef': 0.1, 'loss_losses': ['labels', 'masks', 'boxes'], 'loss_num_points': -1, 'loss_oversample_ratio': 3.0, 'loss_importance_sample_ratio': 0.75, 'loss_class_weights': -1}
2023-08-22 11:33:12,528 INFO    MainThread:28379 [wandb_run.py:_config_callback():1152] config_cb None None {'config/general/train_mode': True, 'config/general/task': 'instance_segmentation', 'config/general/seed': 'None', 'config/general/checkpoint': 'None', 'config/general/backbone_checkpoint': 'None', 'config/general/freeze_backbone': False, 'config/general/linear_probing_backbone': False, 'config/general/train_on_segments': True, 'config/general/eval_on_segments': True, 'config/general/filter_out_instances': False, 'config/general/save_visualizations': False, 'config/general/visualization_point_size': 20, 'config/general/decoder_id': -1, 'config/general/export': False, 'config/general/use_dbscan': False, 'config/general/ignore_class_threshold': 100, 'config/general/project_name': 'scannet', 'config/general/workspace': 'jonasschult', 'config/general/experiment_name': 'dn to bbox gpu0', 'config/general/num_targets': 19, 'config/general/add_instance': True, 'config/general/dbscan_eps': 0.95, 'config/general/dbscan_min_points': 1, 'config/general/export_threshold': 0.0001, 'config/general/reps_per_epoch': 1, 'config/general/on_crops': False, 'config/general/scores_threshold': 0.0, 'config/general/iou_threshold': 1.0, 'config/general/area': 5, 'config/general/eval_inner_core': -1, 'config/general/topk_per_image': 100, 'config/general/ignore_mask_idx': [], 'config/general/max_batch_size': 99999999, 'config/general/save_dir': 'saved/dn to bbox gpu0', 'config/general/gpus': 1, 'config/data/train_mode': 'train', 'config/data/validation_mode': 'validation', 'config/data/test_mode': 'validation', 'config/data/ignore_label': 255, 'config/data/add_raw_coordinates': True, 'config/data/add_colors': True, 'config/data/add_normals': False, 'config/data/in_channels': 3, 'config/data/num_labels': 20, 'config/data/add_instance': True, 'config/data/task': 'instance_segmentation', 'config/data/pin_memory': False, 'config/data/num_workers': 4, 'config/data/batch_size': 3, 'config/data/test_batch_size': 1, 'config/data/cache_data': False, 'config/data/voxel_size': 0.02, 'config/data/reps_per_epoch': 1, 'config/data/cropping': False, 'config/data/cropping_args/min_points': 30000, 'config/data/cropping_args/aspect': 0.8, 'config/data/cropping_args/min_crop': 0.5, 'config/data/cropping_args/max_crop': 1.0, 'config/data/crop_min_size': 20000, 'config/data/crop_length': 6.0, 'config/data/cropping_v1': True, 'config/data/train_dataloader/_target_': 'torch.utils.data.DataLoader', 'config/data/train_dataloader/shuffle': True, 'config/data/train_dataloader/pin_memory': False, 'config/data/train_dataloader/num_workers': 4, 'config/data/train_dataloader/batch_size': 3, 'config/data/validation_dataloader/_target_': 'torch.utils.data.DataLoader', 'config/data/validation_dataloader/shuffle': False, 'config/data/validation_dataloader/pin_memory': False, 'config/data/validation_dataloader/num_workers': 4, 'config/data/validation_dataloader/batch_size': 1, 'config/data/test_dataloader/_target_': 'torch.utils.data.DataLoader', 'config/data/test_dataloader/shuffle': False, 'config/data/test_dataloader/pin_memory': False, 'config/data/test_dataloader/num_workers': 4, 'config/data/test_dataloader/batch_size': 1, 'config/data/train_dataset/_target_': 'datasets.semseg.SemanticSegmentationDataset', 'config/data/train_dataset/dataset_name': 'scannet', 'config/data/train_dataset/data_dir': 'data/processed/scannet', 'config/data/train_dataset/image_augmentations_path': 'conf/augmentation/albumentations_aug.yaml', 'config/data/train_dataset/volume_augmentations_path': 'conf/augmentation/volumentations_aug.yaml', 'config/data/train_dataset/label_db_filepath': 'data/processed/scannet/label_database.yaml', 'config/data/train_dataset/color_mean_std': 'data/processed/scannet/color_mean_std.yaml', 'config/data/train_dataset/data_percent': 1.0, 'config/data/train_dataset/mode': 'train', 'config/data/train_dataset/ignore_label': 255, 'config/data/train_dataset/num_labels': 20, 'config/data/train_dataset/add_raw_coordinates': True, 'config/data/train_dataset/add_colors': True, 'config/data/train_dataset/add_normals': False, 'config/data/train_dataset/add_instance': True, 'config/data/train_dataset/instance_oversampling': 0.0, 'config/data/train_dataset/place_around_existing': False, 'config/data/train_dataset/point_per_cut': 0, 'config/data/train_dataset/max_cut_region': 0, 'config/data/train_dataset/flip_in_center': False, 'config/data/train_dataset/noise_rate': 0, 'config/data/train_dataset/resample_points': 0, 'config/data/train_dataset/add_unlabeled_pc': False, 'config/data/train_dataset/cropping': False, 'config/data/train_dataset/cropping_args/min_points': 30000, 'config/data/train_dataset/cropping_args/aspect': 0.8, 'config/data/train_dataset/cropping_args/min_crop': 0.5, 'config/data/train_dataset/cropping_args/max_crop': 1.0, 'config/data/train_dataset/is_tta': False, 'config/data/train_dataset/crop_min_size': 20000, 'config/data/train_dataset/crop_length': 6.0, 'config/data/train_dataset/filter_out_classes': [0, 1], 'config/data/train_dataset/label_offset': 2, 'config/data/validation_dataset/_target_': 'datasets.semseg.SemanticSegmentationDataset', 'config/data/validation_dataset/dataset_name': 'scannet', 'config/data/validation_dataset/data_dir': 'data/processed/scannet', 'config/data/validation_dataset/image_augmentations_path': 'None', 'config/data/validation_dataset/volume_augmentations_path': 'None', 'config/data/validation_dataset/label_db_filepath': 'data/processed/scannet/label_database.yaml', 'config/data/validation_dataset/color_mean_std': 'data/processed/scannet/color_mean_std.yaml', 'config/data/validation_dataset/data_percent': 1.0, 'config/data/validation_dataset/mode': 'validation', 'config/data/validation_dataset/ignore_label': 255, 'config/data/validation_dataset/num_labels': 20, 'config/data/validation_dataset/add_raw_coordinates': True, 'config/data/validation_dataset/add_colors': True, 'config/data/validation_dataset/add_normals': False, 'config/data/validation_dataset/add_instance': True, 'config/data/validation_dataset/cropping': False, 'config/data/validation_dataset/is_tta': False, 'config/data/validation_dataset/crop_min_size': 20000, 'config/data/validation_dataset/crop_length': 6.0, 'config/data/validation_dataset/filter_out_classes': [0, 1], 'config/data/validation_dataset/label_offset': 2, 'config/data/test_dataset/_target_': 'datasets.semseg.SemanticSegmentationDataset', 'config/data/test_dataset/dataset_name': 'scannet', 'config/data/test_dataset/data_dir': 'data/processed/scannet', 'config/data/test_dataset/image_augmentations_path': 'None', 'config/data/test_dataset/volume_augmentations_path': 'None', 'config/data/test_dataset/label_db_filepath': 'data/processed/scannet/label_database.yaml', 'config/data/test_dataset/color_mean_std': 'data/processed/scannet/color_mean_std.yaml', 'config/data/test_dataset/data_percent': 1.0, 'config/data/test_dataset/mode': 'validation', 'config/data/test_dataset/ignore_label': 255, 'config/data/test_dataset/num_labels': 20, 'config/data/test_dataset/add_raw_coordinates': True, 'config/data/test_dataset/add_colors': True, 'config/data/test_dataset/add_normals': False, 'config/data/test_dataset/add_instance': True, 'config/data/test_dataset/cropping': False, 'config/data/test_dataset/is_tta': False, 'config/data/test_dataset/crop_min_size': 20000, 'config/data/test_dataset/crop_length': 6.0, 'config/data/test_dataset/filter_out_classes': [0, 1], 'config/data/test_dataset/label_offset': 2, 'config/data/train_collation/_target_': 'datasets.utils.VoxelizeCollate', 'config/data/train_collation/ignore_label': 255, 'config/data/train_collation/voxel_size': 0.02, 'config/data/train_collation/mode': 'train', 'config/data/train_collation/small_crops': False, 'config/data/train_collation/very_small_crops': False, 'config/data/train_collation/batch_instance': False, 'config/data/train_collation/probing': False, 'config/data/train_collation/task': 'instance_segmentation', 'config/data/train_collation/ignore_class_threshold': 100, 'config/data/train_collation/filter_out_classes': [0, 1], 'config/data/train_collation/label_offset': 2, 'config/data/train_collation/num_queries': 100, 'config/data/validation_collation/_target_': 'datasets.utils.VoxelizeCollate', 'config/data/validation_collation/ignore_label': 255, 'config/data/validation_collation/voxel_size': 0.02, 'config/data/validation_collation/mode': 'validation', 'config/data/validation_collation/batch_instance': False, 'config/data/validation_collation/probing': False, 'config/data/validation_collation/task': 'instance_segmentation', 'config/data/validation_collation/ignore_class_threshold': 100, 'config/data/validation_collation/filter_out_classes': [0, 1], 'config/data/validation_collation/label_offset': 2, 'config/data/validation_collation/num_queries': 100, 'config/data/test_collation/_target_': 'datasets.utils.VoxelizeCollate', 'config/data/test_collation/ignore_label': 255, 'config/data/test_collation/voxel_size': 0.02, 'config/data/test_collation/mode': 'validation', 'config/data/test_collation/batch_instance': False, 'config/data/test_collation/probing': False, 'config/data/test_collation/task': 'instance_segmentation', 'config/data/test_collation/ignore_class_threshold': 100, 'config/data/test_collation/filter_out_classes': [0, 1], 'config/data/test_collation/label_offset': 2, 'config/data/test_collation/num_queries': 100, 'config/logging': ["{'_target_': 'pytorch_lightning.loggers.WandbLogger', 'project': '${general.project_name}', 'name': '${general.experiment_name}', 'save_dir': '${general.save_dir}', 'entity': 'schult', 'resume': 'allow', 'id': '${general.experiment_name}'}"], 'config/model/_target_': 'models.Mask3D', 'config/model/hidden_dim': 128, 'config/model/dim_feedforward': 1024, 'config/model/num_queries': 100, 'config/model/num_heads': 8, 'config/model/num_decoders': 3, 'config/model/dropout': 0.0, 'config/model/pre_norm': False, 'config/model/use_level_embed': False, 'config/model/normalize_pos_enc': True, 'config/model/positional_encoding_type': 'fourier', 'config/model/gauss_scale': 1.0, 'config/model/hlevels': [0, 1, 2, 3], 'config/model/anchor_dim': 6, 'config/model/non_parametric_queries': False, 'config/model/random_query_both': False, 'config/model/random_normal': False, 'config/model/random_queries': False, 'config/model/use_np_features': False, 'config/model/query_selection': True, 'config/model/sample_sizes': [200, 800, 3200, 12800, 51200], 'config/model/max_sample_size': False, 'config/model/shared_decoder': True, 'config/model/num_classes': 19, 'config/model/train_on_segments': True, 'config/model/scatter_type': 'mean', 'config/model/voxel_size': 0.02, 'config/model/config/backbone/_target_': 'models.Res16UNet34C', 'config/model/config/backbone/config/dialations': [1, 1, 1, 1], 'config/model/config/backbone/config/conv1_kernel_size': 5, 'config/model/config/backbone/config/bn_momentum': 0.02, 'config/model/config/backbone/in_channels': 3, 'config/model/config/backbone/out_channels': 20, 'config/model/config/backbone/out_fpn': True, 'config/metrics/_target_': 'models.metrics.ConfusionMatrix', 'config/metrics/num_classes': 20, 'config/metrics/ignore_label': 255, 'config/optimizer/_target_': 'torch.optim.AdamW', 'config/optimizer/lr': 0.0001, 'config/scheduler/scheduler/_target_': 'torch.optim.lr_scheduler.OneCycleLR', 'config/scheduler/scheduler/max_lr': 0.0001, 'config/scheduler/scheduler/epochs': 1001, 'config/scheduler/scheduler/steps_per_epoch': -1, 'config/scheduler/pytorch_lightning_params/interval': 'step', 'config/trainer/deterministic': False, 'config/trainer/max_epochs': 1001, 'config/trainer/min_epochs': 1, 'config/trainer/resume_from_checkpoint': 'None', 'config/trainer/check_val_every_n_epoch': 50, 'config/trainer/num_sanity_val_steps': 2, 'config/callbacks': ["{'_target_': 'pytorch_lightning.callbacks.ModelCheckpoint', 'monitor': 'val_mean_ap_50', 'save_last': True, 'save_top_k': 1, 'mode': 'max', 'dirpath': '${general.save_dir}', 'filename': '{epoch}-{val_mean_ap_50:.3f}', 'every_n_epochs': 1}", "{'_target_': 'pytorch_lightning.callbacks.LearningRateMonitor'}"], 'config/matcher/_target_': 'models.matcher.HungarianMatcher', 'config/matcher/cost_class': 2.0, 'config/matcher/cost_mask': 5.0, 'config/matcher/cost_dice': 2.0, 'config/matcher/num_points': -1, 'config/loss/_target_': 'models.criterion.SetCriterion', 'config/loss/num_classes': 19, 'config/loss/eos_coef': 0.1, 'config/loss/losses': ['labels', 'masks', 'boxes'], 'config/loss/num_points': -1, 'config/loss/oversample_ratio': 3.0, 'config/loss/importance_sample_ratio': 0.75, 'config/loss/class_weights': -1}
